version: '3.4'

services:

    demanddb:
        container_name: demanddb
        restart: always
        volumes: 
            - ~/mongo/data:/data/demanddb
        ports:
            - "5001:27017"

    demands.api:
        environment:
            - ASPNETCORE_ENVIRONMENT=Development
            - "DemandDatabaseSettings:ConnectionString=mongodb://demanddb:27017"
        ports:
            - "8001:80"
        volumes:
            - ~/.aspnet/https:/root/.aspnet/https:ro
            - ~/.microsoft/usersecrets:/root/.microsoft/usersecrets:ro

        depends_on:
            - "demanddb"


    customerdb:
        container_name: customerdb
        restart: always
        volumes: 
            - ~/mongo/data:/data/customerdb
        ports:
            - "5002:27017"

    customer.api:
        environment:
            - ASPNETCORE_ENVIRONMENT=Development
            - "CustomerDatabaseSettings:ConnectionString=mongodb://customerdb:27017"
        ports:
            - "8002:80"
        volumes:
            - ~/.aspnet/https:/root/.aspnet/https:ro
            - ~/.microsoft/usersecrets:/root/.microsoft/usersecrets:ro

    companydb:
        container_name: companydb
        restart: always
        volumes: 
            - ~/mongo/data:/data/companydb
        ports:
            - "5003:27017"

    company.api:
        environment:
            - ASPNETCORE_ENVIRONMENT=Development
            - "CompanyDatabaseSettings:ConnectionString=mongodb://companydb:27017"
        ports:
            - "8003:80"
        volumes:
            - ~/.aspnet/https:/root/.aspnet/https:ro
            - ~/.microsoft/usersecrets:/root/.microsoft/usersecrets:ro

    vehicledb:
        container_name: vehicledb
        restart: always
        volumes: 
            - ~/mongo/data:/data/vehicledb
        ports:
            - "5005:27017"

    vehicle.api:
        environment:
            - ASPNETCORE_ENVIRONMENT=Development
            - "VehicleDatabaseSettings:ConnectionString=mongodb://vehicledb:27017"
        ports:
            - "8005:80"
        volumes:
            - ~/.aspnet/https:/root/.aspnet/https:ro
            - ~/.microsoft/usersecrets:/root/.microsoft/usersecrets:ro

    offerdb:
        container_name: offerdb
        restart: always
        volumes: 
            - ~/mongo/data:/data/offerdb
        ports:
            - "5008:27017"

    offer.api:
        environment:
            - ASPNETCORE_ENVIRONMENT=Development
            - "OfferDatabaseSettings:ConnectionString=mongodb://offerdb:27017"
        ports:
            - "8008:80"
        volumes:
            - ~/.aspnet/https:/root/.aspnet/https:ro
            - ~/.microsoft/usersecrets:/root/.microsoft/usersecrets:ro
            